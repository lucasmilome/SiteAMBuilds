{% load static %}

<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faça o login</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'account/css/login.css' %}">
</head>

<body class="background">
    <main class="main-container">
        <div class="logo-container">
            <img src="{% static 'setup/icons/logo.png' %}" alt="logo-ambuilds" class="logo">
        </div>
        <div class="login-container">
            <h1 class="title">Acesse sua conta</h1>
            <form action="{% url 'login' %}" method="post">
                {% csrf_token %}
                <div class="input-container">
                    <span class="input-icon">
                        <i class="fas fa-user"></i>
                    </span>
                    {{ form.login }}
                </div>
                <div class="input-container">
                    <span class="input-icon">
                        <i class="fas fa-lock"></i>
                    </span>
                    {{ form.password }}
                    <a class="input-icon-right" id="togglePassword" tabindex="0" style="cursor:pointer;">
                        <i class="fas fa-eye-slash" id="togglePasswordIcon"></i>
                    </a>
                </div>
                <div class="login-options-row mb-2">
                    <div class="form-check m-0">
                        <input class="form-check-input" type="checkbox" name="remember_me" id="rememberMe">
                        <label class="form-check-label" for="rememberMe" class="remember_text">
                            Lembre meus dados
                        </label>
                    </div>
                    <a href="{% url 'password_reset' %}" class="forgot-link">Esqueci minha senha?</a>
                </div>
                <div class="login-error-message" id="loginErrorMsg">
                    {% if messages.error %}
                    {% for message in messages.error %}
                    {{ message }}
                    {% endfor %}
                    {% endif %}
                </div>
                <!-- <div class="login-message" id="loginErrorMsg">
                    {% if messages.success %}
                    {% for message in messages.success %}
                    {{ message }}
                    {% endfor %}
                    {% endif %}
                </div> -->
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        var errorMsg = document.getElementById('loginErrorMsg');
                        if (errorMsg && errorMsg.textContent.trim() !== "") {
                            setTimeout(function () {
                                errorMsg.style.opacity = '0';
                            }, 10000);
                            setTimeout(function () {
                                if (errorMsg) errorMsg.style.display = 'none';
                            }, 10500);
                        }
                    });
                </script>
                <div class="login-btn-row">
                    <button type="submit" class="login_btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="30px" fill="currentColor"
                            class="bi bi-box-arrow-in-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd"
                                d="M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0z" />
                            <path fill-rule="evenodd"
                                d="M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z" />
                        </svg>
                        Entrar
                    </button>
                    <span class="register_text">
                        Não tem uma conta?
                        <a href="{% url 'register' %}" class="signup-link">Crie uma agora</a>
                    </span>
                </div>
            </form>
        </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
        crossorigin="anonymous"></script>
</body>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const togglePassword = document.getElementById('togglePassword');
        const togglePasswordIcon = document.getElementById('togglePasswordIcon');
        // Tenta encontrar o input de senha pelo nome do campo do form
        const passwordInput = document.querySelector('input[type="password"]');
        if (togglePassword && togglePasswordIcon && passwordInput) {
            togglePassword.addEventListener('click', function (e) {
                e.preventDefault();
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    togglePasswordIcon.classList.remove('fa-eye-slash');
                    togglePasswordIcon.classList.add('fa-eye');
                } else {
                    passwordInput.type = 'password';
                    togglePasswordIcon.classList.remove('fa-eye');
                    togglePasswordIcon.classList.add('fa-eye-slash');
                }
            });
        }
    });
</script>

</html>